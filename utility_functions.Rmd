---
title: "Lottery Analysis"
author: sebastian deri
date: jan-feb 2021
output: html_notebook
---

# --- Settings ---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
plot_save <- FALSE
```


# --- Packages ---

```{r}
library(tidyverse)

```


# --- Data ---

# 1. create data

```{r}
# make vector of possible incomes
money <- seq(0, 100, 1)

# turn into data frame
df_util <- data.frame(money)

# show df
df_util

```

# --- Analysis ---

# 2. linear utility

## 2.1. make data

```{r}
max_income <- 500e3
income <- seq(0, 1, 0.01) * max_income
happiness <- income/max(income) * 1000

df_linear <- data.frame(income = income,
                        happiness = happiness)

df_linear
```

## 2.2. actually graph

```{r, fig.width=10, fig.height=6}
df_linear %>% 
  ggplot(aes(x = income,
             y = happiness)) +
  geom_line() +
  labs(title = "How Money Translates to Happiness",
       x = "Total Wealth ($)",
       y = "Total Happiness \n (Measured in Personal Happiness Points)") +
  scale_y_continuous(breaks = seq(0, max(df_linear$happiness), 100),
                     labels = scales::comma) +
  scale_x_continuous(breaks = seq(0, 500e3, 25e3),
                     labels = scales::dollar_format()) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5),
        axis.title.x = element_text(margin = margin(t = 10, b = 0, r = 0, l = 0)),
        axis.text.x = element_text(angle = 45,
                                   hjust = 1))

```

# 3. concave utility

## 3.1. make data

```{r}
max_income <- 500e3
income <- seq(0, 1, 0.01) * max_income
happiness <- (1-((income-max_income)^4)/(max_income^4)) * 1000

df_concave <- data.frame(income = income,
                        happiness = happiness)

df_concave
```

## 3.2. actually graph

```{r, fig.width=10, fig.height=6}
df_concave %>% 
  ggplot(aes(x = income,
             y = happiness)) +
  geom_line() +
  labs(title = "How Money Translates to Happiness",
       x = "Total Wealth ($)",
       y = "Total Happiness \n (Measured in Personal Happiness Points)") +
  scale_y_continuous(breaks = seq(0, max(df_concave$happiness), 100),
                     labels = scales::comma) +
  #scale_y_continuous(limits = c(0,  1))
  scale_x_continuous(breaks = seq(0, 500e3, 25e3),
                     labels = scales::dollar_format()) +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5),
        axis.title.x = element_text(margin = margin(t = 10, b = 0, r = 0, l = 0)),
        axis.text.x = element_text(angle = 45,
                                   hjust = 1))

```

# --- END/MISC ---

